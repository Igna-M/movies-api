<!DOCTYPE html>
<head>
  <%- include('./partials/head') %>
</head>

<html>
  <body>
    <div class="width80center">
      <%- include('./partials/header') %>
    </div>
    
    <main>
      <%- include('./partials/lists-buttons') %>
      <div>
      <% if (message) { %>
        <h2><%= message %></h2>
      <% } else { %>  
        <h2>Resgister film</h2>
      <% } %>
      <div>

        <!-- <form action="/newMovie" method="POST" autocomplete="on"> -->
        <form action="/newMovie" method="POST" autocomplete="on" enctype="multipart/form-data" id="form">
          <div class="">
            <label for="Title">Title:</label><br>
            <% if (locals.errors && errors.title) { %>
              <div class="validator-error">
                  <%= errors.title.msg %> 
                  <br>
              </div>
          <% } %>
            <input type="text" name="title" id="title" placeholder="Title" value="<%= locals.originalData ? originalData.title : null %>">
          </div>


          <div class="">
            <label for="Score">Score:</label><br>
            <% if (locals.originalData && originalData.score) { %> 
              <select name="score" id="score">
              <% for (let i = 1; i < 6; i++) { %> 
                <% if (originalData.score == i) { %> 
                  <option value="<%= i %>" selected><%= i %></option>
                <% } else { %>
                  <option value="<%= i %>"><%= i %></option>
                <% } %>
              <% } %>
              </select>
            <% } else { %>
              <select name="score" id="score">
                <% for (let i = 1; i < 6; i++) { %> 
                  <option value="<%= i %>" ><%= i %></option>
                <% } %>
              </select>
            <% } %>
          </div>


          <!--  -->
          <div id="character-container" class="character-container-style">

            <div class="" id="character1">
              <label for="firstCharacter">Character #1</label><br>
              <% if (locals.originalData && originalData.character1) { %> 
                <select name="character1" id="character1">
                  <% for (let i = 0; i < characters.length; i++) { %> 
                    <% if (originalData.character1 == characters[i].id) { %> 
                      <option value="<%= characters[i].id %>" selected><%= characters[i].name %></option>
                    <% } else { %>
                      <option value="<%= characters[i].id %>" ><%= characters[i].name %></option>
                    <% } %>
                  <% } %>
                  <% if (originalData.character1 == 'new') { %> 
                    <option selected value='new'>Add new character</option>
                  <% } else { %>
                    <option value='new'>Add new character</option>
                  <% } %>
                </select>
              <% } else { %>
                <select name="character1" id="character1">
                  <% for (let i = 0; i < characters.length; i++) { %> 
                    <option value="<%= characters[i].id %>" ><%= characters[i].name %></option>
                  <% } %>
                    <option value='new'>Add new character</option>
                </select>
              <% } %>
            </div>


            <!-- <div class="" id="character1">
              <label for="firstCharacter">Character #1:</label><br>
              <% if (locals.errors && errors.character1) { %>
                <div class="validator-error">
                    <%= errors.character1.msg %>
                    <br>
                </div>
              <% } %>
              <input type="text" name="character1" id="character1" placeholder="First Character" value="<%= locals.originalData ? originalData.character1 : null %>">
            </div> -->

            <% if (locals.originalData && originalData.character2) { %>
              <div class="" id="character2">
              <label for="secondCharacter">Character #2</label><br>
              <select name="character2" id="character2">
                <% for (let i = 0; i < characters.length; i++) { %> 
                  <% if (originalData.character2 == characters[i].id) { %> 
                    <option value="<%= characters[i].id %>" selected><%= characters[i].name %></option>
                  <% } else { %>
                    <option value="<%= characters[i].id %>" ><%= characters[i].name %></option>
                  <% } %>
                <% } %>
                  <% if (originalData.character2 == 'new') { %> 
                    <option selected value='new'>Add new character</option>
                  <% } else { %>
                    <option value='new'>Add new character</option>
                  <% } %>
                </select>
              </div>
            <% } else { %>
              <div class="hide" id="character2">
                <label for="secondCharacter">Character #2</label><br>
                <select name="character2" id="character2">
                  <% for (let i = 0; i < characters.length; i++) { %> 
                    <option value="<%= characters[i].id %>" ><%= characters[i].name %></option>
                  <% } %>
                    <option value='new'>Add new character</option>
                </select>
              </div>
            <% } %>
            



            <% if (locals.originalData && originalData.character3) { %>
              <div class="" id="character3">
              <label for="secondCharacter">Character #3</label><br>
              <select name="character3" id="character3">
                <% for (let i = 0; i < characters.length; i++) { %> 
                  <% if (originalData.character3 == characters[i].id) { %> 
                    <option value="<%= characters[i].id %>" selected><%= characters[i].name %></option>
                  <% } else { %>
                    <option value="<%= characters[i].id %>" ><%= characters[i].name %></option>
                  <% } %>
                <% } %>
                  <% if (originalData.character3 == 'new') { %> 
                    <option selected value='new'>Add new character</option>
                  <% } else { %>
                    <option value='new'>Add new character</option>
                  <% } %>
                </select>
              </div>
            <% } else { %>
              <div class="hide" id="character3">
                <label for="secondCharacter">Character #3</label><br>
                <select name="character3" id="character3">
                  <% for (let i = 0; i < characters.length; i++) { %> 
                    <option value="<%= characters[i].id %>" ><%= characters[i].name %></option>
                  <% } %>
                    <option value='new'>Add new character</option>
                </select>
              </div>
            <% } %>

            <div class="hide" id="new-character-button">
              <a href="/createCharacter" id="new-character-button" class="new-op-button">
                <span>create new character</span>
              </a>
            </div>

          </div> 


          <!--  -->
          <div id="genre1-container" class="genre-container-style">
            <div class="" id="divGenre1">
              <label for="genre1">Genre #1</label><br>
              <% if (locals.originalData && originalData.genre1) { %> 
                <select name="genre1" id="genre1">
                  <% for (let i = 0; i < genres.length; i++) { %> 
                    <% if (originalData.genre1 == genres[i].id) { %> 
                      <option value="<%= genres[i].id %>" selected><%= genres[i].name %></option>
                    <% } else { %>
                      <option value="<%= genres[i].id %>" ><%= genres[i].name %></option>
                    <% } %>
                  <% } %>
                  <% if (originalData.genre1 == 'new') { %> 
                    <option selected value='new'>Add new genre</option>
                  <% } else { %>
                    <option value='new'>Add new genre</option>
                  <% } %>
                </select>
              <% } else { %>
                <select name="genre1" id="genre1">
                  <% for (let i = 0; i < genres.length; i++) { %> 
                    <option value="<%= genres[i].id %>" ><%= genres[i].name %></option>
                  <% } %>
                    <option value='new'>Add new genre</option>
                </select>
              <% } %>
            </div>



            <% if (locals.errors && originalData.genre1 == "new") { %>
              <div class="" id="newGenre1">
                <label for="NewGenre1">Add new genre:</label><br>
                <% if (errors.NewGenre1) { %>
                <div class="validator-error">
                    <%= errors.NewGenre1.msg %>
                    <br>
                </div>
                <% } %>
                <input type="text" name="NewGenre1" id="NewGenre1" value="<%= locals.originalData ? originalData.NewGenre1 : null %>">
              </div>
            <% } else { %>
              <div class="hide" id="newGenre1">
                <label for="NewGenre1">Add new genre:</label><br>
                <input type="text" name="NewGenre1" id="NewGenre1" placeholder="Type new genre" value="<%= locals.originalData ? originalData.newGenre1 : null %>">
              </div>
            <% } %>
          </div>


          <!--  -->
          <div id="genre2-container" class="hide">
            <div class="hide" id="divGenre2">
              <label for="genre2">Genre #2</label><br>
              <% if (locals.originalData && originalData.genre2) { %> 
                <select name="genre2" id="genre2">
                  <% for (let i = 0; i < genres.length; i++) { %> 
                    <% if (originalData.genre2 == genres[i].id) { %> 
                      <option value="<%= genres[i].id %>" selected><%= genres[i].name %></option>
                    <% } else { %>
                      <option value="<%= genres[i].id %>" ><%= genres[i].name %></option>
                    <% } %>
                  <% } %>
                  <% if (originalData.genre2 == 'new') { %> 
                    <option selected value='new'>Add new genre</option>
                  <% } else { %>
                    <option value='new'>Add new genre</option>
                  <% } %>
                </select>
              <% } else { %>
                <select name="genre2" id="genre2">
                  <% for (let i = 0; i < genres.length; i++) { %> 
                    <option value="<%= genres[i].id %>" ><%= genres[i].name %></option>
                  <% } %>
                    <option value='new'>Add new genre</option>
                </select>
              <% } %>
            </div>



            <% if (locals.errors && originalData.genre2 == "new") { %>
              <div class="" id="newGenre2">
                <label for="NewGenre2">Add new genre:</label><br>
                <% if (errors.NewGenre2) { %>
                <div class="validator-error">
                    <%= errors.NewGenre2.msg %>
                    <br>
                </div>
                <% } %>
                <input type="text" name="NewGenre2" id="NewGenre2" value="<%= locals.originalData ? originalData.NewGenre2 : null %>">
              </div>
            <% } else { %>
              <div class="hide" id="newGenre2">
                <label for="NewGenre2">Add new genre:</label><br>
                <input type="text" name="NewGenre2" id="NewGenre2" placeholder="Type new genre" value="<%= locals.originalData ? originalData.newGenre2 : null %>">
              </div>
            <% } %>
          </div>



          <!--  -->
          <div id="genre3-container" class="hide">
            <div class="hide" id="divGenre3">
              <label for="genre3">Genre #3</label><br>
              <% if (locals.originalData && originalData.genre3) { %> 
                <select name="genre3" id="genre3">
                  <% for (let i = 0; i < genres.length; i++) { %> 
                    <% if (originalData.genre3 == genres[i].id) { %> 
                      <option value="<%= genres[i].id %>" selected><%= genres[i].name %></option>
                    <% } else { %>
                      <option value="<%= genres[i].id %>" ><%= genres[i].name %></option>
                    <% } %>
                  <% } %>
                  <% if (originalData.genre3 == 'new') { %> 
                    <option selected value='new'>Add new genre</option>
                  <% } else { %>
                    <option value='new'>Add new genre</option>
                  <% } %>
                </select>
              <% } else { %>
                <select name="genre3" id="genre3">
                  <% for (let i = 0; i < genres.length; i++) { %> 
                    <option value="<%= genres[i].id %>" ><%= genres[i].name %></option>
                  <% } %>
                    <option value='new'>Add new genre</option>
                </select>
              <% } %>
            </div>



            <% if (locals.errors && originalData.genre3 == "new") { %>
              <div class="" id="newGenre3">
                <label for="NewGenre3">Add new genre:</label><br>
                <% if (errors.NewGenre3) { %>
                <div class="validator-error">
                    <%= errors.NewGenre3.msg %>
                    <br>
                </div>
                <% } %>
                <input type="text" name="NewGenre3" id="NewGenre3" value="<%= locals.originalData ? originalData.NewGenre3 : null %>">
              </div>
            <% } else { %>
              <div class="hide" id="newGenre3">
                <label for="NewGenre3">Add new genre:</label><br>
                <input type="text" name="NewGenre3" id="NewGenre3" placeholder="Type new genre" value="<%= locals.originalData ? originalData.newGenre3 : null %>">
              </div>
            <% } %>


          </div>




        <div class="">
          <% if (locals.errors && errors.release) { %>
            <div class="validator-error">
                <%= errors.release.msg %> 
            </div>
          <% } %>
          <label for="release">Release Date:</label><br>
          <input type="date" name="release" id="release" value="<%= locals.originalData ? originalData.release : null %>">
        </div>



        <div class="">
          <label>Movie Poster</label><br>
          <% if (locals.errors && errors.moviePoster) { %>
            <div class="validator-error">
                <%= errors.moviePoster.msg %>
            </div>
        <% } else if (locals.errors){ %>
            <div class="validator-error">
                Please, upload the poster again.
            </div>
        <% } %>
          <input type="file" name="moviePoster" id="file">
          
      </div>

      <br>

        <div class="">
          <input type="submit" value="Create movie">
        </div>
          
        <br>
        
        </form>
        
      </div>
      
      
      <div class="width80center">
        <%- include('./partials/create-buttons') %>
        <%- include('./partials/foot-footnote') %>
      </div>
      <br>
    </main>
    <script src="/javascripts/createMovie.js"></script>
  </body>
</html>
